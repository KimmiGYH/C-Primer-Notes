**练习12.8：下面的函数是否有错误？如果有，解释错误原因。**

```cpp
bool b() {
    int* p = new int;
    // ...
    return p;
}
```

解答：理解用 `new` 分配内存成功和失败的差别，以及复习类型转换。

从程序片段看，可以猜测程序员的意图是通过 `new` 返回的指针值来区分内存分配成功或失败——成功返回一个合法指针，转换为整型是一个非零值，可以转换为 `bool` 值 `true`；分配失败，`p` 得到 `nullptr`，其整型值是 `0`，可转换为 `bool` 值 `false`。

但普通 `new` 调用在分配失败时，抛出一个异常 `bad_alloc`，而不是返回 `nullptr`，因此程序不能达到预想的目的。

可将 `new int` 改为 `new (nothrow) int` 来令 `new` 在分配失败时不抛出异常，而是返回 `nullptr`。但这仍然不是一个好方法，应该通过捕获异常或是判断返回的指针返回 `true` 或 `false`，而不是依赖类型转换。
